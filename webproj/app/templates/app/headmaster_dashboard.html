{% extends "./base.html" %}
{% load static %}


{% block title %}Headmaster's Dashboard{% endblock %}

{% block content %}
<style>
    /* Similar styling as provided, customized for the headmaster's dashboard */
    .dashboard-card, .dashboard-main-card {
        background-color: rgba(255, 255, 255, 0.8);
        backdrop-filter: blur(10px);
    }
    .dashboard-card:hover {
        background-color: rgba(255, 255, 255, 0.6);
    }
</style>

<h2 class="text-4xl font-bold text-center mt-10">Headmaster <span class="text-amber-600">{{ headmaster.name }}</span>'s Dashboard</h2>
<div class="mt-10 flex flex-col items-center justify-center">
    <div class="container mx-auto px-6 rounded-lg">
        <div class="dashboard-main-card shadow-xl rounded-lg p-6 mb-10">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-gray-800">
                <p><strong>Name:</strong> {{ headmaster.name }}</p>
                <p><strong>Gender:</strong> {{ headmaster.gender }}</p>
                <p><strong>Species:</strong> {{ headmaster.species }}</p>
                <p><strong>Blood Type:</strong> {{ headmaster.blood_type }}</p>
                <p><strong>Wand:</strong> {{ headmaster.wand }}</p>
                <p><strong>Patronus:</strong> {{ headmaster.patronus }}</p>
                <p><strong class="text-amber-600">Started headmaster role on:</strong> {{ headmaster.start_date }}</p>
            </div>
            <div class="mt-10">
                <div class="dashboard-card bg-white rounded-lg shadow p-4">
                    <h3 class="text-2xl font-semibold mb-3">Courses</h3>
                    <div id="coursesContainer" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <!-- Courses will be inserted dynamically -->
                    </div>
                </div>
            </div>
            <div class="mt-10 flex flex-col items-center justify-center">
                <div class="container mx-auto px-6">
                    <div class="dashboard-main-card shadow-xl rounded-lg p-6 mb-10">
                        <h3 class="text-2xl font-semibold mb-3">Students</h3>
                        <div class="overflow-x-auto">
                            <table class="min-w-full leading-normal">
                                <thead>
                                    <tr>
                                        <th class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                                            Name
                                        </th>
                                        <th class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                                            Gender
                                        </th>
                                        <th class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                                            Blood Type
                                        </th>
                                        <th class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                                            Species
                                        </th>
                                        <!-- Add other fields as needed -->
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for student in students %}
                                        <tr>
                                            <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">
                                                <div class="flex items-center">
                                                    <div class="ml-3">
                                                        <p class="text-gray-900 whitespace-no-wrap">
                                                            {{ student.name }}
                                                        </p>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">
                                                <p class="text-gray-900 whitespace-no-wrap">{{ student.gender }}</p>
                                            </td>
                                            <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">
                                                <p class="text-gray-900 whitespace-no-wrap">{{ student.blood_type }}</p>
                                            </td>
                                            <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">
                                                <p class="text-gray-900 whitespace-no-wrap">{{ student.species }}</p>
                                            </td>
                                            <!-- Add other fields as needed -->
                                        </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="courseModal" class="fixed inset-0 z-50 hidden overflow-y-auto" aria-labelledby="modal-title" role="dialog" aria-modal="true">
    <div class="flex items-center justify-center min-h-screen">
        <div class="fixed inset-0 bg-gray-500 bg-opacity-75"></div>
        <div class="bg-white rounded-lg overflow-hidden shadow-xl transform transition-all sm:w-full sm:max-w-lg">
            <div class="px-4 pt-5 pb-4 bg-white">
                <div class="sm:flex sm:items-start">
                    <div class="mt-3 text-center sm:mt-0 sm:text-left w-full">
                        <h3 class="text-lg leading-6 font-medium text-gray-900" id="courseName">
                            <!-- Course name will be inserted here -->
                        </h3>
                        <div class="mt-4">
                            <div class="flex flex-col space-y-2" id="courseDetails">
                                <!-- Course details will be dynamically inserted here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                <button type="button" class="mt-3 w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-amber-600 text-base font-medium text-white hover:bg-amber-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-amber-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm" onclick="closeModal()">
                    Close
                </button>
            </div>
        </div>
    </div>
</div>


<script>
    const courses = {{ courses|safe }};
    console.log(courses);
    
    function openModal(courseId) {
        const course = courses.find(c => c.id == courseId);
        if (!course) return;
    
        // Populate modal with course details
        document.getElementById('courseName').innerText = course.name;
        const details = document.getElementById('courseDetails');
        details.innerHTML = `
            <p><strong>Year:</strong> ${course.attending_year}</p>
            <p><strong>Type:</strong> ${course.type}</p>
            <p><strong>Professor:</strong> ${course.professor_info.name}</p>
            <p><strong>Number of Spells Taught:</strong> ${course.number_spells_taught}</p>
        `;
    
        // Show the modal
        document.getElementById('courseModal').style.display = 'block';
        document.body.classList.add('modal-active');
    }
    
    function closeModal() {
        document.getElementById('courseModal').style.display = 'none';
        document.body.classList.remove('modal-active');
    }
    
    document.addEventListener('DOMContentLoaded', () => {
        const coursesContainer = document.getElementById('coursesContainer');
        const courseHtml = courses.map(course => `
            <div class="dashboard-card bg-white rounded-lg shadow p-4 cursor-pointer" onclick="openModal('${course.id}')">
                <h3 class="text-2xl font-semibold mb-3">${course.name}</h3>
                <p>Type: ${course.type}</p>
                <p>Year: ${course.attending_year}</p>
            </div>
        `).join('');
        coursesContainer.innerHTML = courseHtml;
    });
</script>
    

{% endblock %}
